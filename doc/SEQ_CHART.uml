@startuml



(_start )-down->(_bbc_start_main )
(_bbc_start_main )-down->(main )
(main )-down->(main_loop )
(main_loop )-down->(event_loop )
(event_loop )-down->(handle_device_data )
(event_loop )-down->(handle_incoming_vpn_data )
(event_loop )-down->(_select_nocancel )
(handle_device_data )-left->(read_packet )
(read_packet ).left.>(read_packet )
(read_packet )-left->(_read_nocancel )
(read_packet )-down->(logger )
(handle_incoming_vpn_data ).down.>(receive_udppacket )
(receive_udppacket )-down->(route )
(handle_device_data )-down->(route )
(route ).down.>(route_mac )
(route ).down.>(route_ipv4 )
(receive_udppacket )-down->(receive_packet )
(receive_packet )-left->(logger )
(handle_incoming_vpn_data ).right.>(recvfrom )
(recvfrom )-down->(recvfrom )
(route_mac )-down->(send_udppacket )
(send_udppacket )-down->(sendto )
(route_mac )-down->(write_packet )
(route_mac )-left->(send_packet )
(send_packet )-right->(logger )
(write_packet )-right->(logger )
(write_packet )-down->(_write_nocancel )
(logger ).down.>(vsnprintf )
(vsnprintf )-down->(__vsnprintf_chk )
(__vsnprintf_chk )-down->(strchrnul )
(__vsnprintf_chk )-down->(_IO_vfprintf_internal )
(_IO_vfprintf_internal )-right->(_GI_IO_default_xsputn )
(__vsnprintf_chk )-down->(_GI_IO_default_xsputn )
(route_ipv4 )-down->(lookup_subnet_ipv4 )
(lookup_subnet_ipv4 )-left->(hash_search )
(lookup_subnet_ipv4 )-down->(_mcount )
(_mcount )-down->(_mcount_internal )
(hash_search )-down->(_mcount )
(handle_incoming_vpn_data )-down->(hash_search )
(event_loop )-down->(_mcount )
(route_ipv4 )-left->(_mcount )
(route_mac )-left->(_mcount )
(send_udppacket )-left->(_mcount )
(logger )-left->(_mcount )
(read_packet )-right->(_mcount )



@enduml
